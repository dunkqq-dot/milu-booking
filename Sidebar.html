<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #8EACCD;      /* éº‹é¹¿è— */
      --secondary: #D7E5CA;    /* æ¸…æ–°ç¶  */
      --accent: #F9F3CC;       /* æŸ”å’Œé‡‘ */
      --text: #4A4A4A;
      --bg: #F8F9FA;
      --white: #FFFFFF;
    }

    body {
      font-family: 'Noto Sans TC', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    /* æ¨™é¡Œå€åŸŸ */
    .header {
      text-align: center;
      padding: 8px 0;
      border-bottom: 2px solid var(--accent);
      margin-bottom: 8px;
    }

    .header h3 {
      margin: 0;
      color: var(--primary);
      font-size: 20px;
      letter-spacing: 1.5px;
    }

    .header p {
      margin: 4px 0 0;
      font-size: 12px;
      color: #999;
    }

    /* å¡ç‰‡å®¹å™¨ */
    .card {
      background: var(--white);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    /* è¼¸å…¥å€å¡Š */
    .field {
      margin-bottom: 16px;
    }

    label {
      display: block;
      font-weight: 500;
      font-size: 13px;
      color: #777;
      margin-bottom: 6px;
      padding-left: 4px;
    }

    input, textarea, select {
      width: 100%;
      box-sizing: border-box;
      padding: 12px 14px;
      border: 1px solid #E0E0E0;
      border-radius: 10px;
      font-size: 14px;
      background-color: #FAFAFA;
      transition: all 0.3s ease;
      outline: none;
    }

    input:focus, textarea:focus, select:focus {
      border-color: var(--primary);
      background-color: var(--white);
      box-shadow: 0 0 0 3px rgba(142, 172, 205, 0.2);
    }

    textarea {
      resize: none;
    }

    /* ä¸‹æ‹‰é¸å–®ç‰¹åˆ¥æ¨£å¼ */
    select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23777' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
    }

    /* æŒ‰éˆ•æ¨£å¼ */
    button {
      width: 100%;
      padding: 14px;
      background-color: var(--primary);
      color: var(--white);
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.3s;
      box-shadow: 0 4px 10px rgba(142, 172, 205, 0.3);
      margin-top: 10px;
    }

    button:hover {
      background-color: #7A9BBD;
    }

    button:active {
      transform: scale(0.98);
    }

    /* ç‹€æ…‹æç¤º */
    #msg {
      margin-top: 16px;
      text-align: center;
      font-size: 14px;
      min-height: 20px;
      transition: color 0.3s;
    }

    .success { color: #527853; font-weight: 500; }
    .loading { color: #888; font-style: italic; }

    /* å”¯è®€å–®è™Ÿæ¨£å¼ */
    .order-id-badge {
      display: inline-block;
      padding: 4px 10px;
      background: var(--accent);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      color: #B2A59B;
      margin-bottom: 12px;
    }
  </style>
</head>
<body>

  <div class="header">
    <h3>ğŸ¦Œ éº‹é¹¿å·¥å…·</h3>
    <p>MOOSE BALLOON ORDER MANAGER</p>
  </div>

  <div class="card">
    <div id="order-badge" class="order-id-badge">è®€å–ä¸­...</div>
    <input type="hidden" id="row">

    <div class="field">
      <label>ğŸˆ å“é …åˆ†é¡</label>
      <select id="category">
        <option value="ä¸€èˆ¬">ä¸€èˆ¬å“é …</option>
        <option value="æ€§åˆ¥">æ€§åˆ¥æ°£çƒ</option>
        <option value="ç©ºé£„">ç©ºé£„æ°£çƒ</option>
        <option value="æ€§åˆ¥ç©ºé£„">æ€§åˆ¥ + ç©ºé£„</option>
      </select>
    </div>

    <div class="field">
      <label>ğŸ“… é€è²¨æ—¥æœŸ</label>
      <input type="text" id="date" placeholder="YYYY/MM/DD">
    </div>

    <div class="field">
      <label>ğŸ•’ é€è²¨æ™‚é–“</label>
      <input type="text" id="time" placeholder="ä¾‹å¦‚ 13:00 - 15:00">
    </div>

    <div class="field">
      <label>ğŸ‘¤ æ”¶ä»¶äººå§“å</label>
      <input type="text" id="name">
    </div>

    <div class="field">
      <label>ğŸ“ é€£çµ¡é›»è©±</label>
      <input type="text" id="phone">
    </div>

    <div class="field">
      <label>ğŸ“ é…é€åœ°å€</label>
      <textarea id="address" rows="2"></textarea>
    </div>

    <div class="field">
      <label>ğŸ“ è¨‚å–®å‚™è¨»</label>
      <textarea id="remark" rows="2"></textarea>
    </div>

    <button onclick="save()">æ›´æ–°è¨‚å–®ä¸¦åŒæ­¥</button>
    <p id="msg"></p>
  </div>

  <script>
    // åˆå§‹åŒ–ï¼šæŠ“å–è³‡æ–™
    window.onload = function() {
      google.script.run.withSuccessHandler(show).getSelectedRowData();
    };

    function show(d) {
      if(!d) {
        document.getElementById('msg').innerHTML = "âŒ è«‹å…ˆé»é¸è©¦ç®—è¡¨ä¸­çš„è¨‚å–®è¡Œ";
        return;
      }
      document.getElementById('row').value = d.row; 
      document.getElementById('order-badge').innerText = "å–®è™Ÿ " + d.id;
      document.getElementById('date').value = d.date;
      document.getElementById('time').value = d.time; 
      document.getElementById('name').value = d.name;
      document.getElementById('phone').value = d.phone; 
      document.getElementById('address').value = d.address;
      document.getElementById('remark').value = d.remark;
      document.getElementById('category').value = d.category;
    }

    function save() {
      const msg = document.getElementById('msg');
      msg.className = "loading";
      msg.innerText = "â³ æ­£åœ¨è™•ç†ä¸­...";

      var f = {
        row: document.getElementById('row').value, 
        date: document.getElementById('date').value,
        time: document.getElementById('time').value, 
        name: document.getElementById('name').value,
        phone: document.getElementById('phone').value, 
        address: document.getElementById('address').value,
        remark: document.getElementById('remark').value, 
        category: document.getElementById('category').value
      };

      google.script.run.withSuccessHandler(function(r){
        msg.className = "success";
        msg.innerText = r;
        // 3ç§’å¾Œæ¸…é™¤è¨Šæ¯
        setTimeout(() => { msg.innerText = ""; }, 3000);
      }).updateOrderData(f);
    }
  </script>
</body>
</html>
